## 115. Чем `Stream` отличается от коллекции

- **Коллекция (**`Collection`**)**:
    
    - Хранит данные в памяти (элементы).
        
    - Предоставляет методы для управления содержимым: добавление, удаление, доступ по индексу/ключу.
        
    - Ориентирована на _данные_.
        
- **Поток (**`Stream`**)**:
    
    - Не хранит элементы, а описывает _вычислительный конвейер_ над источником данных.
        
    - Может быть создан из коллекции, массива, файла, генератора.
        
    - Поддерживает ленивые вычисления: операции выполняются только при вызове терминальной операции.
        
    - Может быть **одноразовым**: после выполнения терминальной операции поток закрывается.
        
    - Ориентирован на _обработку данных_ (трансформации, фильтрации, агрегации).
        

**Ключевое отличие:** коллекция — это контейнер элементов, а поток — это инструмент для декларативной обработки этих элементов.

## 116. Промежуточные и терминальные операции

- **Промежуточные (intermediate):**
    
    - Возвращают новый `Stream`.
        
    - Ленивые — не выполняются сразу, а откладываются до терминальной операции.
        
    - Примеры: `map`, `filter`, `flatMap`, `distinct`, `sorted`, `limit`, `skip`.
        
- **Терминальные (terminal):**
    
    - Запускают выполнение конвейера.
        
    - Возвращают результат (не поток).
        
    - Примеры: `forEach`, `collect`, `reduce`, `count`, `findFirst`, `findAny`, `anyMatch`, `allMatch`.
        

**Пример:**

java

```
List<String> names = List.of("Ann", "Bob", "Alice");
long count = names.stream()
                  .filter(n -> n.startsWith("A")) // промежуточная
                  .count();                       // терминальная
```

## 117. Методы `map()` vs `flatMap()`

- **map():**
    
    - Применяет функцию к каждому элементу.
        
    - Результат — поток преобразованных элементов.
        
    - Пример:
        
        java
        
        ```
        Stream.of("a", "bb", "ccc")
              .map(String::length) // Stream<Integer>
              .forEach(System.out::println);
        ```
        
- **flatMap():**
    
    - Применяет функцию, которая возвращает поток (или коллекцию).
        
    - Все полученные потоки «сплющиваются» в один общий поток.
        
    - Используется для работы с вложенными структурами.
        
    - Пример:
        
        java
        
        ```
        List<List<String>> nested = List.of(List.of("a", "b"), List.of("c", "d"));
        nested.stream()
              .flatMap(List::stream) // Stream<String>
              .forEach(System.out::println);
        ```
        
    - Отличие: `map` создаёт поток потоков (`Stream<Stream<T>>`), а `flatMap` разворачивает их в `Stream<T>`.
        

## 118. Что такое потоковая обработка данных

- **Определение:** это декларативный способ обработки последовательностей данных через конвейер операций (pipeline).
    
- **Особенности:**
    
    - Ленивость: промежуточные операции не выполняются до терминальной.
        
    - Композиция: операции можно комбинировать в цепочку.
        
    - Параллельность: `parallelStream()` позволяет автоматически распараллелить обработку.
        
    - Функциональный стиль: вместо императивных циклов — декларативные выражения (`map`, `filter`, `reduce`).
        
- **Пример:**
    
    java
    
    ```
    int sum = transactions.stream()
                          .filter(t -> t.getType() == Type.DEPOSIT)
                          .mapToInt(Transaction::getAmount)
                          .sum();
    ```
    
    Здесь мы описали _что_ нужно сделать, а не _как_.
    

## 119. Нововведения начиная с Java 8

Java 8 — революционный релиз, который принёс функциональные возможности:

- **Лямбда-выражения** — компактный синтаксис для реализации функциональных интерфейсов.
    
- **Функциональные интерфейсы** (`Function`, `Predicate`, `Consumer`, `Supplier` и др.).
    
- **Stream API** — декларативная обработка коллекций и данных.
    
- **Default и static методы в интерфейсах** — возможность добавлять реализацию без ломки API.
    
- **Методные ссылки** (`Class::method`) — сокращение для лямбд.
    
- **Optional** — контейнер для значения или его отсутствия, альтернатива `null`.
    
- **Новый Date/Time API (**`java.time`**)** — современная работа с датами и временем (вдохновлён JodaTime).
    
- **Nashorn JavaScript Engine** (устарел в более поздних версиях).
    
- **CompletableFuture** — расширенные возможности асинхронного программирования.
    
- **Параллельные стримы** — автоматическое распараллеливание обработки данных.