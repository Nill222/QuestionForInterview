# Spring (–ù–∞—á–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å)

## 1. –ß—Ç–æ —Ç–∞–∫–æ–µ IoC –∏ DI

üîπ **IoC (Inversion of Control)** ‚Äî —ç—Ç–æ –ø—Ä–∏–Ω—Ü–∏–ø, –∫–æ–≥–¥–∞ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (Spring)** —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–∑–¥–∞–Ω–∏–µ–º –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ–±—ä–µ–∫—Ç–æ–≤ –≤–º–µ—Å—Ç–æ —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –¥–µ–ª–∞–ª `new MyClass()` –≤—Ä—É—á–Ω—É—é.

- –†–∞–Ω—å—à–µ:
    
    `Service service = new Service(new Repository());`
    
- –í Spring:
    
    `@Autowired private Service service;`
    
    –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–∞–º —Å–æ–∑–¥–∞—Å—Ç `Repository`, –ø–æ—Ç–æ–º `Service`, –∏ –≤–Ω–µ–¥—Ä–∏—Ç –∫—É–¥–∞ –Ω—É–∂–Ω–æ.
    

**–ì–ª–∞–≤–Ω–∞—è –∏–¥–µ—è IoC** ‚Üí –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–∞–º–æ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏, –∞ –æ—Ç–¥–∞—ë—Ç —ç—Ç–æ –Ω–∞ Spring.

---

üîπ **DI (Dependency Injection)** ‚Äî —ç—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ IoC: –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤–Ω–µ–¥—Ä—è—é—Ç—Å—è –≤ –æ–±—ä–µ–∫—Ç:

- —á–µ—Ä–µ–∑ **–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä**
    
- —á–µ—Ä–µ–∑ **—Å–µ—Ç—Ç–µ—Ä**
    
- —á–µ—Ä–µ–∑ **–ø–æ–ª–µ** (–∞–Ω–Ω–æ—Ç–∞—Ü–∏—è `@Autowired`)
    

üëâ –ü—Ä–æ—â–µ –≥–æ–≤–æ—Ä—è: **IoC ‚Äî —ç—Ç–æ –ø—Ä–∏–Ω—Ü–∏–ø, DI ‚Äî —ç—Ç–æ –µ–≥–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è**.

---

## 2. –í–∏–¥—ã –±–∏–Ω–æ–≤: @Component, @Service, @Repository

Spring —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å—ã –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç –∏—Ö –∫–∞–∫ **–±–∏–Ω—ã** (–æ–±—ä–µ–∫—Ç—ã, –∫–æ—Ç–æ—Ä—ã–º–∏ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä).  
–ê–Ω–Ω–æ—Ç–∞—Ü–∏–∏ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ **—Å–º—ã—Å–ª–æ–º** (–¥–ª—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∏ AOP), –Ω–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –≤—Å–µ —ç—Ç–æ `@Component`.

- `@Component` ‚Üí –±–∞–∑–æ–≤—ã–π bean (–æ–±—ã—á–Ω—ã–π –∫–ª–∞—Å—Å)
    
- `@Service` ‚Üí –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ (—Å–µ—Ä–≤–∏—Å—ã)
    
- `@Repository` ‚Üí DAO-—Å–ª–æ–π (—Ä–∞–±–æ—Ç–∞ —Å –ë–î). –û—Ç–ª–∏—á–∏–µ: Spring —É–º–µ–µ—Ç **–ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è** –∏ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å `SQLException` –≤ `DataAccessException`.
    
- `@Controller` / `@RestController` ‚Üí –≤–µ–±-—Å–ª–æ–π (–æ–±—Ä–∞–±–æ—Ç–∫–∞ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤).
    

---

## 3. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

Spring –∏—â–µ—Ç, –∫–∞–∫–æ–π –±–∏–Ω –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è.

- –ü–æ —Ç–∏–ø—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, –Ω—É–∂–µ–Ω `UserService` ‚Üí –∏—â–µ—Ç –±–∏–Ω —ç—Ç–æ–≥–æ –∫–ª–∞—Å—Å–∞).
    
- –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–∏–Ω–æ–≤ –æ–¥–Ω–æ–≥–æ —Ç–∏–ø–∞ ‚Üí –Ω—É–∂–Ω–∞ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è `@Qualifier("beanName")`.
    
- –ï—Å–ª–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞ ‚Üí `@Autowired(required = true)` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).
    
- –ï—Å–ª–∏ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ ‚Üí `@Autowired(required = false)` –∏–ª–∏ `@Nullable`.
    

üìå –í–∞–∂–Ω–æ: –Ω–∞—á–∏–Ω–∞—è —Å Spring 4.3 –º–æ–∂–Ω–æ **–±–µ–∑ `@Autowired`**, –µ—Å–ª–∏ –≤ –∫–ª–∞—Å—Å–µ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä ‚Äî Spring –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –µ–≥–æ –≤—ã–±–µ—Ä–µ—Ç.

---

## 4. ApplicationContext –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –±–∏–Ω–∞

### üîπ ApplicationContext

- –≠—Ç–æ **–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Spring**, –∫–æ—Ç–æ—Ä—ã–π —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º–∏ –±–∏–Ω–∞–º–∏.
    
- –°–æ–∑–¥–∞—ë—Ç –∏—Ö, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —É–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º.
    
- –†–∞—Å—à–∏—Ä—è–µ—Ç `BeanFactory` (–Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä).
    

–ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- `AnnotationConfigApplicationContext` (Java Config)
    
- `ClassPathXmlApplicationContext` (XML, —É—Å—Ç–∞—Ä–µ–ª–æ)
    
- `WebApplicationContext` (–¥–ª—è Spring MVC)
    

---

### üîπ –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –±–∏–Ω–∞ (–æ—á–µ–Ω—å –ª—é–±—è—Ç –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—è—Ö)

1. Spring —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å—ã –∏ –Ω–∞—Ö–æ–¥–∏—Ç –±–∏–Ω—ã.
    
2. –°–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç (`new`).
    
3. –í–Ω–µ–¥—Ä—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (DI).
    
4. –ï—Å–ª–∏ –±–∏–Ω —Ä–µ–∞–ª–∏–∑—É–µ—Ç `BeanNameAware`, `ApplicationContextAware` ‚Üí –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è —Å—Å—ã–ª–∫–∏.
    
5. –í—ã–∑—ã–≤–∞—é—Ç—Å—è `BeanPostProcessor` (–Ω–∞–ø—Ä–∏–º–µ—Ä, `@Autowired`, `@Transactional` —Ä–∞–±–æ—Ç–∞—é—Ç —Ç—É—Ç).
    
6. –ï—Å–ª–∏ –µ—Å—Ç—å `@PostConstruct` –∏–ª–∏ `InitializingBean.afterPropertiesSet()` ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è.
    
7. –ë–∏–Ω –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.
    
8. –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
    
    - –≤—ã–∑—ã–≤–∞—é—Ç—Å—è `@PreDestroy` –∏–ª–∏ `DisposableBean.destroy()`.

## 1. **IoC –∏ DI**

- **IoC (Inversion of Control, –∏–Ω–≤–µ—Ä—Å–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è)** ‚Äî –ø—Ä–∏–Ω—Ü–∏–ø, –ø–æ –∫–æ—Ç–æ—Ä–æ–º—É –Ω–µ —Ç—ã —É–ø—Ä–∞–≤–ª—è–µ—à—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –æ–±—ä–µ–∫—Ç–æ–≤, –∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (Spring).  
    ‚ú® –ü—Ä–∏–º–µ—Ä: —Ä–∞–Ω—å—à–µ —Ç—ã —Å–∞–º –ø–∏—Å–∞–ª `new Service()`, —Ç–µ–ø–µ—Ä—å Spring —Å–∞–º —Å–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç –∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –µ–≥–æ —Ç—É–¥–∞, –≥–¥–µ –æ–Ω –Ω—É–∂–µ–Ω.
    
- **DI (Dependency Injection, –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π)** ‚Äî —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ IoC.  
    –°—É—â–µ—Å—Ç–≤—É–µ—Ç 3 –≤–∞—Ä–∏–∞–Ω—Ç–∞:
    
    - **Constructor Injection** (—á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π —Å–ø–æ—Å–æ–±, immutable –∏ —É–¥–æ–±–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)
        
    - **Setter Injection** (—á–µ—Ä–µ–∑ —Å–µ—Ç—Ç–µ—Ä—ã, –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è)
        
    - **Field Injection** (—á–µ—Ä–µ–∑ `@Autowired` –ø—Ä—è–º–æ –≤ –ø–æ–ª–µ ‚Äî –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, —Å–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å).
        

üîß –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º:  
Spring –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–æ–∑–¥–∞—ë—Ç **ApplicationContext** ‚Üí —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å—ã ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç –±–∏–Ω—ã (`@Component`, `@Service`, `@Repository`, `@Controller`) ‚Üí –∫–ª–∞–¥—ë—Ç –∏—Ö –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Üí –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏—â–µ—Ç –Ω—É–∂–Ω—ã–π –±–∏–Ω –ø–æ —Ç–∏–ø—É (–∏–ª–∏ –ø–æ –∏–º–µ–Ω–∏, –µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç) ‚Üí –≤–Ω–µ–¥—Ä—è–µ—Ç.

---

## 2. **–í–∏–¥—ã –±–∏–Ω–æ–≤**

Spring –ø–æ–º–µ—á–∞–µ—Ç –∫–ª–∞—Å—Å—ã –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è–º–∏, –∏ –æ–Ω–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

- `@Component` ‚Äî –±–∞–∑–æ–≤–∞—è –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è, –æ–±—ã—á–Ω—ã–π –±–∏–Ω.
    
- `@Service` ‚Äî —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –º–∞—Ä–∫–µ—Ä –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Å–ª–æ—è (–±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞).
    
- `@Repository` ‚Äî –¥–ª—è DAO-—Å–ª–æ—è, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç SQL-–∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ `DataAccessException`.
    
- `@Controller` / `@RestController` ‚Äî –¥–ª—è web-—Å–ª–æ—è (MVC).
    

üëâ –í—Å–µ –æ–Ω–∏ ‚Äî –ø—Ä–æ—Å—Ç–æ —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–∏ `@Component`, –Ω–æ Spring –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Ö –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å–ª–æ—ë–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## 3. **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

–î–æ–ø—É—Å—Ç–∏–º:

`@Service 
public class UserService {     
private final UserRepository userRepository;      
public UserService(UserRepository userRepository) {        
this.userRepository = userRepository; // DI —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä     } }`

- Spring –≤–∏–¥–∏—Ç `UserService` –∫–∞–∫ –±–∏–Ω.
    
- –û–Ω –∏—â–µ—Ç, –∫–∞–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω—É–∂–Ω—ã (`UserRepository`).
    
- –ù–∞—Ö–æ–¥–∏—Ç –±–∏–Ω `UserRepository` (–æ—Ç–º–µ—á–µ–Ω–Ω—ã–π `@Repository`).
    
- –°–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç `UserRepository`, –∫–ª–∞–¥—ë—Ç –µ–≥–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.
    
- –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç `UserService`, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –≤ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä.
    

‚ú® –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç —Ä–µ—Ñ–ª–µ–∫—Å–∏—è (—á–µ—Ä–µ–∑ `ConstructorResolver` –∏ `AutowiredAnnotationBeanPostProcessor`).

---

## 4. **ApplicationContext –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –±–∏–Ω–∞**

- **ApplicationContext** ‚Äî —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Spring, –≤ –∫–æ—Ç–æ—Ä–æ–º –∂–∏–≤—É—Ç –≤—Å–µ –±–∏–Ω—ã.
    
- –û–Ω —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö —Å–æ–∑–¥–∞–Ω–∏–µ–º, —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º, —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ–º.
    

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –±–∏–Ω–∞:

1. –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ (—á–µ—Ä–µ–∑ `new`).
    
2. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
    
3. –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ `@PostConstruct` (–µ—Å–ª–∏ –µ—Å—Ç—å).
    
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∏–Ω–∞ (–æ–Ω –∂–∏–≤—ë—Ç –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ).
    
5. –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–æ–≤ `@PreDestroy` (–µ—Å–ª–∏ –µ—Å—Ç—å), –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    

üëâ –û–±—ã—á–Ω–æ –±–∏–Ω—ã –≤ Spring **singleton** (–æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞ –≤–µ—Å—å –∫–æ–Ω—Ç–µ–∫—Å—Ç), –Ω–æ –µ—Å—Ç—å –∏ –¥—Ä—É–≥–∏–µ scope:

- `singleton` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
    
- `prototype` (–Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ)
    
- `request`, `session` (–¥–ª—è web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π).

## 1. ApplicationContext –∏ BeanFactory

- **BeanFactory** ‚Äî —ç—Ç–æ _core_ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Spring.  
    –û–Ω –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞:
    
    - —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –±–∏–Ω–æ–≤ (–∏–º—è, –∫–ª–∞—Å—Å, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏);
        
    - —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏—Ö –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º;
        
    - –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
        
- **ApplicationContext** = `BeanFactory` + —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:
    
    - –ø–æ–¥–¥–µ—Ä–∂–∫–∞ _–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–∑–∞—Ü–∏–∏_ (i18n);
        
    - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π (event listeners);
        
    - –∞–≤—Ç–æ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (`@ComponentScan`);
        
    - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å AOP –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏;
        
    - —É–¥–æ–±–Ω—ã–µ —Ö—É–∫–∏ (`BeanPostProcessor`, `ApplicationListener`, `Environment` –∏ —Ç.–¥.).
        

üëâ –¢–æ –µ—Å—Ç—å `ApplicationContext` ‚Äî —ç—Ç–æ –Ω–∞–¥—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞–¥ `BeanFactory`, –¥–µ–ª–∞—é—â–∞—è —Ä–∞–±–æ—Ç—É –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–π.

---

## 2. –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∑–∞–ø—É—Å–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–ö–æ–≥–¥–∞ —Ç—ã –ø–æ–¥–Ω–∏–º–∞–µ—à—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ `AnnotationConfigApplicationContext` –∏–ª–∏ Spring Boot), –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Ü–µ–ø–æ—á–∫–∞ —à–∞–≥–æ–≤:

1. **–ß—Ç–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö**  
    Spring —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–ª–∞—Å—Å—ã –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (`@Configuration`, `@Component`, `@Bean`) ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –æ–ø–∏—Å–∞–Ω–∏–µ –≤ `BeanDefinitionMap`.
    
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è BeanDefinition**  
    –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ Spring —Ö—Ä–∞–Ω–∏—Ç:
    
    - –∏–º—è (id);
        
    - —Ç–∏–ø;
        
    - scope (`singleton`, `prototype` –∏ —Ç.–ø.);
        
    - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏;
        
    - –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ (`@Transactional`, `@Lazy`, `@Profile` –∏ —Ç.–ø.).
        
3. **–°–æ–∑–¥–∞–Ω–∏–µ –±–∏–Ω–æ–≤**  
    –ö–æ–≥–¥–∞ –±–∏–Ω –≤–ø–µ—Ä–≤—ã–µ –Ω—É–∂–µ–Ω (–∏–ª–∏ —Å—Ä–∞–∑—É, –µ—Å–ª–∏ singleton eager):
    
    - –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä;
        
    - –≤–Ω–µ–¥—Ä—è—é—Ç—Å—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`@Autowired`, `@Value`, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä, —Å–µ—Ç—Ç–µ—Ä).
        
4. **BeanPostProcessors (–º–∞–≥–∏—è Spring)**  
    –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –±–∏–Ω–∞ Spring –ø—Ä–æ–≥–æ–Ω—è–µ—Ç –µ–≥–æ —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É `BeanPostProcessor`:
    
    - `@Autowired` ‚Üí `AutowiredAnnotationBeanPostProcessor`;
        
    - `@Transactional` ‚Üí `AnnotationAwareAspectJAutoProxyCreator`;
        
    - `@ConfigurationProperties` ‚Üí `ConfigurationPropertiesBindingPostProcessor`;  
        –∏ —Ç.–¥.
        
    
    üëâ –ò–º–µ–Ω–Ω–æ —Ç—É—Ç —Å–æ–∑–¥–∞—é—Ç—Å—è **–ø—Ä–æ–∫—Å–∏-–æ–±—ä–µ–∫—Ç—ã** –¥–ª—è AOP –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π.
    
5. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**  
    –ï—Å–ª–∏ –±–∏–Ω —Ä–µ–∞–ª–∏–∑—É–µ—Ç `InitializingBean` –∏–ª–∏ –ø–æ–º–µ—á–µ–Ω `@PostConstruct`, –≤—ã–∑—ã–≤–∞—é—Ç—Å—è –º–µ—Ç–æ–¥—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.
    
6. **–ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ**  
    –ë–∏–Ω –ø–æ–º–µ—â–∞–µ—Ç—Å—è –≤ `singletonCache` (–µ—Å–ª–∏ –æ–Ω singleton) ‚Üí –¥–æ—Å—Ç—É–ø–µ–Ω –¥—Ä—É–≥–∏–º.
    
7. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ**  
    –ü—Ä–∏ `context.close()` Spring –≤—ã–∑—ã–≤–∞–µ—Ç `@PreDestroy` –∏–ª–∏ `DisposableBean.destroy()`.
    

---

## 3. Proxy –∏ AOP –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º

- –ï—Å–ª–∏ –±–∏–Ω –ø–æ–º–µ—á–µ–Ω `@Transactional` –∏–ª–∏ –ø–æ–ø–∞–¥–∞–µ—Ç –ø–æ–¥ –∞—Å–ø–µ–∫—Ç `@Around`, Spring –Ω–µ –æ—Ç–¥–∞—ë—Ç —Ç–µ–±–µ —Å–∞–º –æ–±—ä–µ–∫—Ç.
    
- –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞—ë—Ç—Å—è **–ø—Ä–æ–∫—Å–∏**:
    
    - JDK Dynamic Proxy (–µ—Å–ª–∏ –±–∏–Ω —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å);
        
    - CGLIB Proxy (–µ—Å–ª–∏ –±–∏–Ω ‚Äî –∫–ª–∞—Å—Å –±–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤).
        
- –ü—Ä–æ–∫—Å–∏ "–æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç" –≤—ã–∑–æ–≤—ã –º–µ—Ç–æ–¥–æ–≤:
    
    1. –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞ –∏–¥—ë—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏.
        
    2. –ü—Ä–æ–∫—Å–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É Interceptor-–æ–≤ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä).
        
    3. –ü–æ—Ç–æ–º –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç –≤—ã–∑–æ–≤ –Ω–∞—Å—Ç–æ—è—â–µ–º—É –æ–±—ä–µ–∫—Ç—É.
        

üëâ –ü–æ—ç—Ç–æ–º—É `@Transactional` —Ä–∞–±–æ—Ç–∞–µ—Ç **—Ç–æ–ª—å–∫–æ –Ω–∞ –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–∞—Ö**, –≤—ã–∑—ã–≤–∞–µ–º—ã—Ö –∏–∑–≤–Ω–µ (—á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏).

---

## 4. BeanPostProcessor –∏ BeanFactoryPostProcessor

- **BeanFactoryPostProcessor** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç _–¥–æ_ —Å–æ–∑–¥–∞–Ω–∏—è –±–∏–Ω–æ–≤, –º–æ–∂–µ—Ç –º–µ–Ω—è—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (`BeanDefinition`). –ü—Ä–∏–º–µ—Ä: `PropertySourcesPlaceholderConfigurer` –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç `${}` –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.
    
- **BeanPostProcessor** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç _–ø–æ—Å–ª–µ_ —Å–æ–∑–¥–∞–Ω–∏—è –±–∏–Ω–∞, –Ω–æ _–¥–æ_ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è. –ü—Ä–∏–º–µ—Ä: `AutowiredAnnotationBeanPostProcessor` –≤–Ω–µ–¥—Ä—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.
    

---

## 5. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (DI)

–ö–∞–∫ Spring —Ä–µ—à–∞–µ—Ç, –∫–∞–∫–æ–π –±–∏–Ω –≤–Ω–µ–¥—Ä–∏—Ç—å –≤ `@Autowired`?

1. –°–º–æ—Ç—Ä–∏—Ç –ø–æ —Ç–∏–ø—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, `UserService`).
    
2. –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ ‚Äî –∏—â–µ—Ç `@Primary` –∏–ª–∏ `@Qualifier`.
    
3. –ï—Å–ª–∏ –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç ‚Üí –æ—à–∏–±–∫–∞ `NoSuchBeanDefinitionException`.
    

---

## 6. –ò—Ç–æ–≥

- **ApplicationContext** ‚Äî —ç—Ç–æ "—Å—É–ø–µ—Ä–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä" Spring, –∫–æ—Ç–æ—Ä—ã–π:
    
    - —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ `BeanDefinition`;
        
    - —É–ø—Ä–∞–≤–ª—è–µ—Ç –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –æ–±—ä–µ–∫—Ç–æ–≤;
        
    - —É–º–µ–µ—Ç –≤–Ω–µ–¥—Ä—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏;
        
    - –¥–æ–±–∞–≤–ª—è–µ—Ç –º–∞–≥–∏—é —á–µ—Ä–µ–∑ –ø–æ—Å—Ç-–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã –∏ –ø—Ä–æ–∫—Å–∏.
        
- **–ú–∞–≥–∏—è `@Autowired`, `@Transactional`, `@Aspect`, `@ConfigurationProperties`** —Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è:
    
    - `BeanPostProcessor` –∏ `BeanFactoryPostProcessor`;
        
    - —Å–æ–∑–¥–∞–Ω–∏—é –ø—Ä–æ–∫—Å–∏-–æ–±—ä–µ–∫—Ç–æ–≤;
        
    - AspectJ / CGLIB –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º.

---

# –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç `@Transactional` –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º

## 0) –ü—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∏

- –í–∫–ª—é—á—ë–Ω AOP-—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º: `@EnableTransactionManagement` (–≤ Spring Boot —ç—Ç–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π).
    
- –í –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –µ—Å—Ç—å `PlatformTransactionManager` (—á–∞—â–µ –≤—Å–µ–≥–æ: `DataSourceTransactionManager`, `JpaTransactionManager` –∏–ª–∏ JTA-–º–µ–Ω–µ–¥–∂–µ—Ä).
    

Spring —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç _–∞–≤—Ç–æ–ø—Ä–æ–∫—Å–∏-—Å–æ–∑–¥–∞—Ç–µ–ª—å_ (AutoProxyCreator), –∫–æ—Ç–æ—Ä—ã–π –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –±–∏–Ω—ã –≤ –ø—Ä–æ–∫—Å–∏, –µ—Å–ª–∏ –∏—Ö –º–µ—Ç–æ–¥—ã –ø–æ–¥–ø–∞–¥–∞—é—Ç –ø–æ–¥ `@Transactional`.

---

## 1) –ü—Ä–æ–∫—Å–∏ –≤–æ–∫—Ä—É–≥ –±–∏–Ω–∞

- –ï—Å–ª–∏ —É –±–∏–Ω–∞ –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã ‚Üí –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é **JDK Dynamic Proxy** (–ø—Ä–æ–∫—Å–∏ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã).
    
- –ï—Å–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –Ω–µ—Ç (–∏–ª–∏ —è–≤–Ω–æ —É–∫–∞–∑–∞–Ω–æ) ‚Üí **CGLIB**-–ø—Ä–æ–∫—Å–∏ (–Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Ç –∫–ª–∞—Å—Å–∞).
    
- –ü—Ä–æ–∫—Å–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫ `TransactionInterceptor`.
    

> –ò—Ç–æ–≥: –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –≤–∞—à–µ–≥–æ –º–µ—Ç–æ–¥–∞ –≤—ã –ø–æ–ø–∞–¥–∞–µ—Ç–µ **—Å–Ω–∞—á–∞–ª–∞ –≤ –ø—Ä–æ–∫—Å–∏**, –∞ –Ω–µ —Å—Ä–∞–∑—É –≤ ¬´—Ä–µ–∞–ª—å–Ω—ã–π¬ª –æ–±—ä–µ–∫—Ç.

---

## 2) –í—ã–∑–æ–≤ –º–µ—Ç–æ–¥–∞: —á—Ç–æ –¥–µ–ª–∞–µ—Ç `TransactionInterceptor`

–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –ø—Å–µ–≤–¥–æ–∫–æ–¥ –ª–æ–≥–∏–∫–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∞:

`invoke(method, args) {   // 1) –°—á–∏—Ç–∞—Ç—å –∞—Ç—Ä–∏–±—É—Ç—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏   TransactionAttribute attr = attributeSource.getTransactionAttribute(method, targetClass);    // 2) –ù–∞–π—Ç–∏ TransactionManager (–ø–æQualifier/–∏–º–µ–Ω–∏/—Ç–∏–ø—É)   PlatformTransactionManager tm = determineTransactionManager(attr);    // 3) –û—Ç–∫—Ä—ã—Ç—å/—É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–≥–ª–∞—Å–Ω–æ propagation   TransactionInfo tx = tm.getTransaction(attr.toDefinition());    try {     // 4) –í—ã–∑–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥     Object ret = method.invoke(target, args);      // 5) –£—Å–ø–µ—Ö ‚Üí –∫–æ–º–º–∏—Ç     tm.commit(tx);     return ret;    } catch (Throwable ex) {     // 6) –û—à–∏–±–∫–∞ ‚Üí —Ä–µ—à–∏—Ç—å: –∫–æ–º–º–∏—Ç –∏–ª–∏ –æ—Ç–∫–∞—Ç     if (attr.rollbackOn(ex)) tm.rollback(tx);     else tm.commit(tx); // ¬´–Ω–µ —Ä–æ–ª–±—ç—á–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é¬ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, checked –∏—Å–∫–ª—é—á–µ–Ω–∏—è)     throw ex;   } }`

–ö–ª—é—á–µ–≤–æ–µ: **—Ä–µ—à–µ–Ω–∏–µ –æ rollback/commit –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª –≤ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏** –∏ —Ç–∏–ø–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏—è.

---

## 3) –ß—Ç–æ –¥–µ–ª–∞–µ—Ç `PlatformTransactionManager#getTransaction(...)`

–ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

### `DataSourceTransactionManager` (–∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π JDBC)

- –ë–µ—Ä—ë—Ç `Connection` –∏–∑ –ø—É–ª–∞.
    
- –°—Ç–∞–≤–∏—Ç `autoCommit=false`.
    
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç **—É—Ä–æ–≤–µ–Ω—å –∏–∑–æ–ª—è—Ü–∏–∏**, `readOnly`, `timeout`.
    
- **–ü—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç —Ä–µ—Å—É—Ä—Å –∫ —Ç–µ–∫—É—â–µ–º—É –ø–æ—Ç–æ–∫—É** —á–µ—Ä–µ–∑ `TransactionSynchronizationManager` (ThreadLocal).
    

### `JpaTransactionManager`

- –ü–æ–ª—É—á–∞–µ—Ç/—Å–æ–∑–¥–∞—ë—Ç `EntityManager`, –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç –µ–≥–æ –∫ –ø–æ—Ç–æ–∫—É.
    
- –ü—Ä–∏ –∫–æ–º–º–∏—Ç–µ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç `flush()` —É JPA-–ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (Hibernate), –∑–∞—Ç–µ–º –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç JDBC-–∫–æ–º–º–∏—Ç—É.
    
- –£—á–∏—Ç—ã–≤–∞–µ—Ç –∫–∞—Å–∫–∞–¥–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ Persistence Context.
    

### JTA-–º–µ–Ω–µ–¥–∂–µ—Ä—ã

- –î–µ–ª–µ–≥–∏—Ä—É—é—Ç –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é –≤–Ω–µ—à–Ω–µ–º—É TM (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ/—Å–µ—Ä–≤–∏—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π).
    

---

## 4) `commit` –∏ `rollback` –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ

### Commit

- –î–ª—è JPA: –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ **`flush()`** (—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ —Å –ë–î).
    
- –î–ª—è JDBC: –≤—ã–∑–æ–≤ `connection.commit()`.
    
- –í—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ `TransactionSynchronization` (—Ö—É–∫–∏ ¬´beforeCommit/afterCommit¬ª).
    
- –†–µ—Å—É—Ä—Å—ã –æ—Ç–≤—è–∑—ã–≤–∞—é—Ç—Å—è –æ—Ç –ø–æ—Ç–æ–∫–∞, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –ø—É–ª.
    

### Rollback

- –î–ª—è JPA: –æ—Ç–∫–∞—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏ –ë–î.
    
- –î–ª—è JDBC: `connection.rollback()`.
    
- –°–Ω–∏–º–∞—é—Ç—Å—è/–æ—á–∏—â–∞—é—Ç—Å—è —Ä–µ—Å—É—Ä—Å—ã, —Å–Ω–∏–º–∞—é—Ç—Å—è `savepoint` (–µ—Å–ª–∏ –±—ã–ª–∏).
    
- –í–æ–∑–º–æ–∂–µ–Ω `UnexpectedRollbackException`, –µ—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –ø–æ–º–µ—á–µ–Ω–∞ `rollbackOnly`, –∞ –≤–Ω–µ—à–Ω–∏–π –∫–æ–¥ –ø–æ–ø—ã—Ç–∞–ª—Å—è –∫–æ–º–º–∏—Ç–∏—Ç—å.
    

---

## 5) –ü–æ–≤–µ–¥–µ–Ω–∏–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π (–æ—á–µ–Ω—å –≤–∞–∂–Ω–æ!)

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Spring:

- **–û—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç** –ø—Ä–∏ `RuntimeException` –∏ `Error`.
    
- **–ù–ï –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç** –ø—Ä–∏ _checked_ –∏—Å–∫–ª—é—á–µ–Ω–∏—è—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, `IOException`).
    

–ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å:

`@Transactional(rollbackFor = Exception.class)`

–∏–ª–∏ –Ω–∞–æ–±–æ—Ä–æ—Ç:

`@Transactional(noRollbackFor = CustomBusinessException.class)`

---

## 6) –ü–∞—Ä–∞–º–µ—Ç—Ä—ã `@Transactional`, —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –≤–ª–∏—è–µ—Ç

- `propagation` ‚Äî —É—á–∞—Å—Ç–∏–µ/—Å–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:
    
    - `REQUIRED` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é): –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–µ–∫—É—â—É—é, –∏–Ω–∞—á–µ —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é.
        
    - `REQUIRES_NEW`: –≤—Å–µ–≥–¥–∞ **–Ω–æ–≤–∞—è** —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è (–≤–Ω–µ—à–Ω—è—è –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è).
        
    - `SUPPORTS`: –µ—Å–ª–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –µ—Å—Ç—å ‚Äî —É—á–∞—Å—Ç–≤—É–µ—Ç, –∏–Ω–∞—á–µ –±–µ–∑ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
        
    - `MANDATORY`: —Ç—Ä–µ–±—É–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é, –∏–Ω–∞—á–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ.
        
    - `NOT_SUPPORTED`: –ø—Ä–∏–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–µ–∫—É—â—É—é, –≤—ã–ø–æ–ª–Ω—è–µ—Ç **–≤–Ω–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**.
        
    - `NEVER`: –∑–∞–ø—Ä–µ—â–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
        
    - `NESTED`: –≤–ª–æ–∂–µ–Ω–Ω–∞—è —Å `savepoint` (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å `DataSourceTransactionManager` –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π savepoint; –≤ JPA —á–∞—Å—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ).
        
- `isolation` ‚Äî —É—Ä–æ–≤–µ–Ω—å –∏–∑–æ–ª—è—Ü–∏–∏ (–¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç—Å—è JDBC/–ë–î).
    
- `readOnly` ‚Äî –º–æ–∂–µ—Ç –≤—ã—Å—Ç–∞–≤–ª—è—Ç—å —Ñ–ª–∞–≥ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—é/–ø—Ä–æ–≤–∞–π–¥–µ—Ä—É (–≤ Hibernate –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç `flush`); –Ω–µ ¬´–∑–∞–ø—Ä–µ—â–∞–µ—Ç¬ª –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–∞—Å–∏–ª—å–Ω–æ.
    
- `timeout` ‚Äî –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏; –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –±—É–¥–µ—Ç rollback.
    

---

## 7) –ß–∞—Å—Ç—ã–µ –ø–æ–¥–≤–æ–¥–Ω—ã–µ –∫–∞–º–Ω–∏

1. **Self-invocation (—Å–∞–º–æ–≤—ã–∑–æ–≤)**  
    –í—ã–∑–æ–≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–æ–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ **–∏–∑ –¥—Ä—É–≥–æ–≥–æ –º–µ—Ç–æ–¥–∞ —Ç–æ–≥–æ –∂–µ –∫–ª–∞—Å—Å–∞** –º–∏–Ω—É–µ—Ç –ø—Ä–æ–∫—Å–∏ ‚Üí **—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ —Å—Ç–∞—Ä—Ç—É–µ—Ç**.  
    –†–µ—à–µ–Ω–∏—è:
    

- –í—ã–Ω–µ—Å—Ç–∏ –º–µ—Ç–æ–¥ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–∏–Ω.
    
- –í–Ω–µ–¥—Ä–∏—Ç—å ¬´self-proxy¬ª –∏ –≤—ã–∑—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ –Ω–µ–≥–æ.
    
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AspectJ LTW (–∫–æ–º–ø–∏–ª/–ª–æ–∞–¥-—Ç–∞–π–º –≤–∏–≤–∏–Ω–≥).
    

2. **–ì–¥–µ —Å—Ç–∞–≤–∏—Ç—å `@Transactional`**  
    –°—Ç–∞–≤—å—Ç–µ **–Ω–∞ –º–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** (–∞ –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å), —á—Ç–æ–±—ã –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è —Ç–æ—á–Ω–æ –±—ã–ª–∞ –≤–∏–¥–Ω–∞ –∞—Ç—Ä–∏–±—É—Ç-—Å–æ—Ä—Å—É.  
    –ú–µ—Ç–æ–¥—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **public** (–¥–ª—è –ø—Ä–æ–∫—Å–∏ –∏ AOP —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–æ).  
    `final`/`private`/`static` –º–µ—Ç–æ–¥—ã —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ **–Ω–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è**.
    
3. **–ü—Ä–æ–∫—Å–∏-—Ç–∏–ø –∏ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã**  
    CGLIB –Ω–µ —Å–º–æ–∂–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `final` ‚Äî —Å–æ–≤–µ—Ç/—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ —Å—Ä–∞–±–æ—Ç–∞—é—Ç.
    
4. **–ì—Ä–∞–Ω–∏—Ü—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–ª–∏—à–∫–æ–º —à–∏—Ä–æ–∫–∏–µ**  
    –î–ª–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (—Å–µ—Ç–µ–≤—ã–µ –≤—ã–∑–æ–≤—ã, I/O) —É—Ö—É–¥—à–∞—é—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ü–∏—é –∏ –¥–µ—Ä–∂–∞—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏.  
    –í—ã–Ω–æ—Å–∏—Ç–µ –≤—Å—ë ¬´–ª–∏—à–Ω–µ–µ¬ª –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
    
5. **`@Transactional(readOnly = true)` –∏ –ª–µ–Ω–∏–≤—ã–µ –∫–æ–ª–ª–µ–∫—Ü–∏–∏**  
    –ù–µ –ø—É—Ç–∞–π—Ç–µ —Å ¬´–∑–∞–ø—Ä–µ—Ç–æ–º –∑–∞–ø–∏—Å–∏¬ª. –≠—Ç–æ ¬´—Ö–∏–Ω—Ç¬ª –ø—Ä–æ–≤–∞–π–¥–µ—Ä—É. –ü—Ä–∏ —á—Ç–µ–Ω–∏–∏ —á–µ—Ä–µ–∑ JPA/Hibernate –≤–æ–∑–º–æ–∂–Ω—ã –ª–µ–Ω–∏–≤—ã–µ –∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî —É—á–∏—Ç—ã–≤–∞–π—Ç–µ `OpenEntityManagerInView` –∏–ª–∏ –¥–µ–ª–∞–π—Ç–µ —è–≤–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É –≤ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
    
6. **`REQUIRES_NEW` –∏ –ø—É–ª—ã —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π**  
    –ö–∞–∂–¥–∞—è –Ω–æ–≤–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è. –ü—Ä–∏ –º–∞—Å—Å–æ–≤—ã—Ö –≤—ã–∑–æ–≤–∞—Ö –º–æ–∂–Ω–æ ¬´–≤—ã—Å—É—à–∏—Ç—å¬ª –ø—É–ª.
    
7. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω—â–∏–Ω–∞**  
    `@Async` –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–¥ –≤ **–¥—Ä—É–≥–æ–º –ø–æ—Ç–æ–∫–µ** ‚Üí —Ç–µ–∫—É—â–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –Ω–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–µ—Ç—Å—è. –û—Ç–∫—Ä—ã–≤–∞–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ —Å–∞–º–æ–º async-–º–µ—Ç–æ–¥–µ.
    

---

## 8) –ö–æ—Ä–æ—Ç–∫–∞—è ¬´–¥–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞¬ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

1. –í—ã–∑–≤–∞–ª–∏ `service.doWork()` ‚Üí –ø–æ–ø–∞–ª–∏ –≤ **–ø—Ä–æ–∫—Å–∏**.
    
2. `TransactionInterceptor` —á–∏—Ç–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ `@Transactional`.
    
3. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç `PlatformTransactionManager`.
    
4. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç/–ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (—É—á–∏—Ç—ã–≤–∞—è `propagation/isolation/readOnly/timeout`).
    
5. –í—ã–∑—ã–≤–∞–µ—Ç –≤–∞—à –º–µ—Ç–æ–¥.
    
6. –ï—Å–ª–∏ –≤—Å—ë –æ–∫ ‚Üí `commit` (—Å `flush()` –¥–ª—è JPA).
    
7. –ï—Å–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ ‚Üí —Å–º–æ—Ç—Ä–∏—Ç –ø—Ä–∞–≤–∏–ª–∞, –¥–µ–ª–∞–µ—Ç `rollback`/`commit`.
    
8. –û—á–∏—â–∞–µ—Ç —Ä–µ—Å—É—Ä—Å—ã, –æ—Ç–≤—è–∑—ã–≤–∞–µ—Ç –∏—Ö –æ—Ç –ø–æ—Ç–æ–∫–∞.
    

---

## 9) –ú–∏–Ω–∏-–ø—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫

`@Service public class PaymentService {    // JPA: —Å–æ–∑–¥–∞—Å—Ç/–ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é, —Å–¥–µ–ª–∞–µ—Ç flush –ø–µ—Ä–µ–¥ commit   @Transactional(       propagation = Propagation.REQUIRED,       isolation = Isolation.READ_COMMITTED,       timeout = 5,       rollbackFor = Exception.class)   public void pay(OrderId id) {     // ...   }    // –¢–æ—á–Ω–∞—è –∑–∞–ø–∏—Å—å –∞—É–¥–∏—Ç–∞ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏   @Transactional(propagation = Propagation.REQUIRES_NEW)   public void audit(AuditEvent event) {     // ...   } }`

---

### –ß—Ç–æ –∑–∞–ø–æ–º–Ω–∏—Ç—å –¥–ª—è —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π

- `@Transactional` = –ø—Ä–æ–∫—Å–∏ + `TransactionInterceptor` + `PlatformTransactionManager`.
    
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é rollback —Ç–æ–ª—å–∫–æ –Ω–∞ `RuntimeException`/`Error`.
    
- Self-invocation –ª–æ–º–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.
    
- `REQUIRES_NEW` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é; `NESTED` = savepoint (–Ω–µ –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–µ–Ω —Å JPA).
    
- –†–µ–∞–ª—å–Ω—ã–µ –≥—Ä–∞–Ω–∏—Ü—ã —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ‚Äî —ç—Ç–æ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π **–≤–Ω–µ—à–Ω–∏–π –≤—ã–∑–æ–≤ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –±–∏–Ω–∞** —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏.